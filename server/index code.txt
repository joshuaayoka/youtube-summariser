const cors = require('cors')
const ytt = require('youtube-transcript');
const express = require('express')

const transcriber = ytt.YoutubeTranscript
const app = express()

app.use(cors)


app.listen(4000, () => {
    console.log('Server Works !!! At port 4000');
});

//let transcript = ""


app.get('/', (req,res) => {
    let URL = req.query.URL;
    //res.json({url:URL});

    transcriber.fetchTranscript(URL).then(dataToTranscript).then(console.log)
})

async function fetchData(url) {
    let data = await transcriber.fetchTranscript(url)
    return data
}


function dataToTranscript(transcriptData) {
    //console.log(transcriptData)
    let t = transcriptData.map(entry => (entry.text)).join(' ');
    
    return t
}
let tData = fetchData('https://www.youtube.com/watch?v=A4_TFHzqAAg').then(dataToTranscript).then(console.log)
//dataToTranscript()
//dataToTranscript(transcriber.fetchTranscript('https://www.youtube.com/watch?v=A4_TFHzqAAg'))